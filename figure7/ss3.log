procs = 6 gpus = 1
% MAGMA 2.7.1 svn 32-bit magma_int_t, 64-bit pointer.
% Compiled with CUDA support for 7.0
% CUDA runtime 11060, driver 11070. OpenMP threads 6. 
% device 0: Tesla V100-PCIE-16GB, 1380.0 MHz clock, 16160.7 MiB memory, capability 7.0
% Tue Apr 18 14:52:58 2023
Warmup MPI...
Matrix size: 3000000x300
Step = 0/10
Departure from orthogonality before re-orthogonalizing: 1
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Orthogonalized A
Iterative solve took 20 iterations
Orthogonality check A
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Departure from orthogonality after re-orthogonalizing: 1
Step = 1/10
Departure from orthogonality before re-orthogonalizing: 1
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Orthogonalized A
Iterative solve took 20 iterations
Orthogonality check A
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Departure from orthogonality after re-orthogonalizing: 1
Step = 2/10
Departure from orthogonality before re-orthogonalizing: 1
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Orthogonalized A
Iterative solve took 20 iterations
Orthogonality check A
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Departure from orthogonality after re-orthogonalizing: 1
Step = 3/10
Departure from orthogonality before re-orthogonalizing: 1
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Orthogonalized A
Iterative solve took 20 iterations
Orthogonality check A
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Departure from orthogonality after re-orthogonalizing: 1
Step = 4/10
Departure from orthogonality before re-orthogonalizing: 1
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Orthogonalized A
Iterative solve took 20 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1
Step = 5/10
Departure from orthogonality before re-orthogonalizing: 1
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Orthogonalized A
Iterative solve took 20 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1
Step = 6/10
Departure from orthogonality before re-orthogonalizing: 1
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Orthogonalized A
Iterative solve took 20 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1
Step = 7/10
Departure from orthogonality before re-orthogonalizing: 1
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Orthogonalized A
Iterative solve took 20 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1
Step = 8/10
Departure from orthogonality before re-orthogonalizing: 1
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Orthogonalized A
Iterative solve took 20 iterations
Orthogonality check A
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Departure from orthogonality after re-orthogonalizing: 1
Step = 9/10
Departure from orthogonality before re-orthogonalizing: 1
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
magma free device_inv_sqrt_diagonal_: invalid ptr rep destr
Orthogonalized A
Iterative solve took 20 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1
Timer: matrix_ortho                                      6.28e+00  / 6.29e+00  / 6.29e+00  / 1       / 1       / 1      
Timer: Replicated::allreduce                             6.32e-03  / 6.79e-03  / 7.17e-03  / 10      / 10      / 10     
Timer: Replicated::host_device_transfer                  3.53e-05  / 4.48e-05  / 6.41e-05  / 20      / 20      / 20     
Timer: Replicated::memory_initialization                 1.62e-05  / 1.97e-05  / 2.38e-05  / 10      / 10      / 10     
Timer: Replicated::host_array_allocation                 1.03e-05  / 1.13e-05  / 1.31e-05  / 10      / 10      / 10     
Timer: Replicated::pre_rescale                           3.82e-04  / 4.18e-04  / 4.70e-04  / 10      / 10      / 10     
Timer: Replicated::post_rescale                          2.54e-04  / 2.88e-04  / 3.36e-04  / 10      / 10      / 10     
Timer: Replicated::single_schulz_delta                   9.48e-04  / 9.85e-04  / 1.04e-03  / 10      / 10      / 10     
Timer: Matrix::compute_aTa                               1.76e-05  / 2.08e-05  / 2.57e-05  / 10      / 10      / 10     
Timer: Matrix::matrix_matrix_multiply                    1.34e-05  / 1.49e-05  / 1.60e-05  / 10      / 10      / 10     
magma free device_data invalid ptr
magma free d_work_ invalid ptr
magma free device_data invalid ptr
magma free d_work_ invalid ptr
magma free device_data invalid ptr
magma free d_work_ invalid ptr
magma free device_data invalid ptr
magma free d_work_ invalid ptr
magma free device_data invalid ptr
magma free d_work_ invalid ptr
Timer: Matrix::ortho                                     9.40e-03  / 9.56e-03  / 9.79e-03  / 10      / 10      / 10     
magma free device_data invalid ptr
magma free d_work_ invalid ptr
procs = 12 gpus = 2
% MAGMA 2.7.1 svn 32-bit magma_int_t, 64-bit pointer.
% Compiled with CUDA support for 7.0
% CUDA runtime 11060, driver 11070. OpenMP threads 12. 
% device 0: Tesla V100-PCIE-16GB, 1380.0 MHz clock, 16160.7 MiB memory, capability 7.0
% device 1: Tesla V100-PCIE-16GB, 1380.0 MHz clock, 16160.7 MiB memory, capability 7.0
% Tue Apr 18 14:53:10 2023
Warmup MPI...
Matrix size: 3000000x300
Step = 0/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 1/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 2/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 3/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 4/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 5/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 6/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 7/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 8/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 9/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Timer: matrix_ortho                                      2.04e+01  / 2.04e+01  / 2.04e+01  / 1       / 1       / 1      
Timer: Replicated::allreduce                             1.45e-02  / 6.43e-02  / 1.23e-01  / 10      / 10      / 10     
Timer: Replicated::host_device_transfer                  3.58e-03  / 4.88e-03  / 7.30e-03  / 20      / 20      / 20     
Timer: Replicated::memory_initialization                 1.19e-03  / 2.34e-03  / 5.00e-03  / 10      / 10      / 10     
Timer: Replicated::host_array_allocation                 8.11e-06  / 1.30e-05  / 2.22e-05  / 10      / 10      / 10     
Timer: Replicated::pre_rescale                           3.97e-02  / 4.78e-02  / 5.29e-02  / 10      / 10      / 10     
Timer: Replicated::post_rescale                          2.78e-02  / 5.22e-02  / 6.91e-02  / 10      / 10      / 10     
Timer: Replicated::single_schulz_delta                   9.11e-02  / 2.94e-01  / 4.27e-01  / 10      / 10      / 10     
Timer: Matrix::compute_aTa                               4.06e+00  / 4.12e+00  / 4.18e+00  / 10      / 10      / 10     
Timer: Matrix::matrix_matrix_multiply                    2.10e-01  / 4.62e-01  / 6.10e-01  / 10      / 10      / 10     
Timer: Matrix::ortho                                     4.64e+00  / 5.09e+00  / 5.37e+00  / 10      / 10      / 10     
procs = 18 gpus = 3
% MAGMA 2.7.1 svn 32-bit magma_int_t, 64-bit pointer.
% Compiled with CUDA support for 7.0
% CUDA runtime 11060, driver 11070. OpenMP threads 18. 
% device 0: Tesla V100-PCIE-16GB, 1380.0 MHz clock, 16160.7 MiB memory, capability 7.0
% device 1: Tesla V100-PCIE-16GB, 1380.0 MHz clock, 16160.7 MiB memory, capability 7.0
% device 2: Tesla V100-PCIE-16GB, 1380.0 MHz clock, 16160.7 MiB memory, capability 7.0
% Tue Apr 18 14:53:35 2023
Warmup MPI...
Matrix size: 3000000x300
Step = 0/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.65694e-14
Step = 1/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.65694e-14
Step = 2/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.65694e-14
Step = 3/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.65694e-14
Step = 4/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.65694e-14
Step = 5/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.65694e-14
Step = 6/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.65694e-14
Step = 7/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.65694e-14
Step = 8/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.65694e-14
Step = 9/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.65694e-14
Timer: matrix_ortho                                      1.45e+01  / 1.45e+01  / 1.45e+01  / 1       / 1       / 1      
Timer: Replicated::allreduce                             3.93e-02  / 8.19e-02  / 2.18e-01  / 10      / 10      / 10     
Timer: Replicated::host_device_transfer                  3.98e-03  / 5.42e-03  / 8.54e-03  / 20      / 20      / 20     
Timer: Replicated::memory_initialization                 1.36e-03  / 2.09e-03  / 2.86e-03  / 10      / 10      / 10     
Timer: Replicated::host_array_allocation                 8.58e-06  / 1.54e-05  / 2.62e-05  / 10      / 10      / 10     
Timer: Replicated::pre_rescale                           3.95e-02  / 4.68e-02  / 5.28e-02  / 10      / 10      / 10     
Timer: Replicated::post_rescale                          2.71e-02  / 5.07e-02  / 6.27e-02  / 10      / 10      / 10     
Timer: Replicated::single_schulz_delta                   1.71e-01  / 2.80e-01  / 3.56e-01  / 10      / 10      / 10     
Timer: Matrix::compute_aTa                               2.55e+00  / 2.66e+00  / 2.70e+00  / 10      / 10      / 10     
Timer: Matrix::matrix_matrix_multiply                    1.81e-01  / 2.76e-01  / 3.70e-01  / 10      / 10      / 10     
Timer: Matrix::ortho                                     3.23e+00  / 3.45e+00  / 3.62e+00  / 10      / 10      / 10     
procs = 24 gpus = 4
% MAGMA 2.7.1 svn 32-bit magma_int_t, 64-bit pointer.
% Compiled with CUDA support for 7.0
% CUDA runtime 11060, driver 11070. OpenMP threads 24. 
% device 0: Tesla V100-PCIE-16GB, 1380.0 MHz clock, 16160.7 MiB memory, capability 7.0
% device 1: Tesla V100-PCIE-16GB, 1380.0 MHz clock, 16160.7 MiB memory, capability 7.0
% device 2: Tesla V100-PCIE-16GB, 1380.0 MHz clock, 16160.7 MiB memory, capability 7.0
% device 3: Tesla V100-PCIE-16GB, 1380.0 MHz clock, 16160.7 MiB memory, capability 7.0
% Tue Apr 18 14:53:59 2023
Warmup MPI...
Matrix size: 3000000x300
Step = 0/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 1/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 2/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 3/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 4/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 5/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 6/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 7/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 8/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Step = 9/10
Departure from orthogonality before re-orthogonalizing: 0.239275
Orthogonalized A
Iterative solve took 5 iterations
Orthogonality check A
Departure from orthogonality after re-orthogonalizing: 1.6432e-14
Timer: matrix_ortho                                      1.17e+01  / 1.17e+01  / 1.17e+01  / 1       / 1       / 1      
Timer: Replicated::allreduce                             3.02e-02  / 7.44e-02  / 2.02e-01  / 10      / 10      / 10     
Timer: Replicated::host_device_transfer                  3.45e-03  / 5.07e-03  / 7.40e-03  / 20      / 20      / 20     
Timer: Replicated::memory_initialization                 9.80e-04  / 2.39e-03  / 3.55e-03  / 10      / 10      / 10     
Timer: Replicated::host_array_allocation                 9.06e-06  / 1.62e-05  / 3.03e-05  / 10      / 10      / 10     
Timer: Replicated::pre_rescale                           3.31e-02  / 4.72e-02  / 5.46e-02  / 10      / 10      / 10     
Timer: Replicated::post_rescale                          1.79e-02  / 4.94e-02  / 6.76e-02  / 10      / 10      / 10     
Timer: Replicated::single_schulz_delta                   3.54e-02  / 2.66e-01  / 3.66e-01  / 10      / 10      / 10     
Timer: Matrix::compute_aTa                               1.87e+00  / 1.97e+00  / 2.02e+00  / 10      / 10      / 10     
Timer: Matrix::matrix_matrix_multiply                    7.93e-02  / 2.40e-01  / 3.28e-01  / 10      / 10      / 10     
Timer: Matrix::ortho                                     2.32e+00  / 2.70e+00  / 2.89e+00  / 10      / 10      / 10     
